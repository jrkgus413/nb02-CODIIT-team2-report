# CODIIT-backend 프로젝트 개발 보고서

> **프로젝트명**: CODI-IT  
> **프로젝트 기간**: 2025.09.15 ~ 2025.11.03  
> **팀명**: 2팀  
> **작성자**: 조가현

---

## 1. 개요

본 프로젝트는 패션/쇼핑몰 플랫폼의 백엔드 서비스를 구축하기 위해 **NestJS**와 **Prisma ORM**을 기반으로 개발되었습니다.  
회원, 상품, 주문, 리뷰, 문의/답변 등 주요 기능을 모듈화하여 구현하였으며,  
**안정성과 확장성**, **테스트 가능성**을 고려한 아키텍처 설계를 목표로 했습니다.  
또한 사용자 인증·인가, 데이터 유효성 검증, 예외 처리, 단위 테스트 등 백엔드 핵심 기술을 적용했습니다.

### 주요 기능 요약

| 모듈          | 주요 기능 요약                                                                                |
| ------------- | --------------------------------------------------------------------------------------------- |
| Auth          | 사용자 인증 및 권한 검증, JWT 토큰 발급 및 검증, 쿠키 관리, 로그인 처리                       |
| Cart          | 장바구니에 상품 추가/삭제, 장바구니 목록 조회, 수량 변경, 장바구니 상태 관리                  |
| Dashboard     | 매출/주문/회원 등 통계 데이터 집계 및 제공, 관리자용 대시보드 API                             |
| Grades        | 회원 등급 산정 로직, 등급별 혜택 관리, 등급 변경 처리                                         |
| Inquiry       | 상품 문의 등록/수정/삭제, 판매자 답변 등록/수정/삭제, 문의/답변 상세 조회                     |
| Notifications | 사용자 알림 생성/전송/삭제, 알림 유형 관리, 실시간 알림 처리                                  |
| Orders        | 주문 생성/수정/삭제, 주문 상태 변경(결제, 배송 등), 주문 내역 조회                            |
| Points        | 포인트 적립/사용/차감, 포인트 내역 조회, 포인트 정책 적용                                     |
| Products      | 상품 등록/수정/삭제, 상품 목록/상세 조회, 상품 상태 관리, 상품 문의 연동                      |
| Review        | 상품 리뷰 등록/수정/삭제, 리뷰 목록/상세 조회                             |
| S3            | 이미지 및 파일 S3 업로드/삭제/조회, 파일 URL 반환                                             |
| Store         | 스토어(판매자) 정보 등록/수정/삭제, 스토어 상품 관리, 관심 스토어 등록/해제, 스토어 상세 조회 |
| Users         | 회원 가입/정보 수정/탈퇴, 사용자 정보 조회, 회원 상태 관리                                    |

---

## 2. 요구사항 및 기획

- 사용자 문의/답변 및 리뷰 기능 제공
- 문의는 상품별 등록, 답변은 판매자만 작성 가능
- 문의/답변/리뷰 모두 작성자만 수정·삭제 가능 (권한 체크 필수)
- 데이터 유효성 검증 및 예외 처리 (리소스 없음, 권한 없음 등)
- 서비스 안정성을 위한 유닛 테스트 및 예외 케이스 검증

---

## 3. 구현 내용

### 3.1 문의 / 답변 관리

#### 문의 (Question)

- 목록/상세 조회, 작성, 수정, 삭제 기능 구현
- 답변이 등록된 문의는 수정 불가하도록 예외 처리

#### 답변 (Answer)

- 해당 상품의 판매자만 답변 작성 가능
- 답변 등록 시 문의 상태 자동 변경 (답변 완료 / 대기)
- 답변 수정·삭제는 작성자만 가능

#### 권한 및 예외 처리

- `NotFoundException`, `UnauthorizedException`, `ConflictException` 등 NestJS 예외 클래스 활용
- 모든 API에서 권한 체크 및 리소스 존재 여부 검증

### 3.2 리뷰 관리

- **작성 조건**

  - 상품 구매자만 작성 가능, 동일 상품 중복 리뷰 불가

- **CRUD 기능**

  - 목록 조회(페이지네이션), 단건 조회, 작성, 수정, 삭제
  - 수정/삭제는 작성자만 가능

- **데이터 검증**
  - `class-validator`를 활용하여 평점, 내용 등 입력값 유효성 검사

### 3.3 테스트 코드 작성

- Jest 기반 서비스 및 컨트롤러 단위 테스트 작성
- 정상 케이스와 실패 케이스를 명확히 구분하여 검증
- Guard, Pipe 등 요청 전 처리 단계의 에러 처리 포함
- Mock 객체를 통해 DB 의존성 제거 및 다양한 예외 상황 테스트

---

## 4. 기술적 특징 및 학습 포인트

- **NestJS 모듈화 구조**

  - Controller, Service, Repository 분리로 역할 명확화
  - 유지보수성과 확장성 향상

- **Prisma ORM 활용**

  - 트랜잭션 처리, 관계형 데이터 조회, select 옵션 활용

- **권한 및 예외 처리 일관성**

  - 모든 API에서 일관된 예외 처리와 권한 체크 적용

- **테스트 코드로 신뢰성 확보**
  - 정상/실패 케이스 모두 검증, 테스트 커버리지 향상

### 학습한 주요 내용

- NestJS의 Guard, Pipe, Interceptor 구조 이해
- Prisma ORM의 트랜잭션 및 관계형 데이터 조회 활용
- 유닛 테스트에서 실패 케이스 설계의 중요성 체감
- 실무 수준의 예외 처리 및 권한 체크 필요성 경험

---

## 5. 트러블슈팅 경험

### 문제점 ① – NestJS 구조 이해 부족

- Express에서는 인증/검증 로직을 주로 미들웨어로 처리했으나,  
  Nest에서는 Guard·Pipe·Interceptor 등으로 역할이 분리되어 처음에 혼란스러웠음

**원인 분석**

- Nest는 관심사 분리를 위해 요청 전후 단계별 훅 구조를 제공하지만,  
  초기에 기존 Express 방식대로 작성하면서 Interceptor에 인증 로직을 잘못 배치하는 실수를 함

**해결 방법**

- 인증 로직은 `@UseGuards()`를 통해 Guard로 이동
- 요청 데이터 유효성 검사는 `@UsePipes()`를 사용하여 Pipe로 처리
- 응답 포맷 통일은 `@UseInterceptors()`를 활용하여 Interceptor로 분리

**결과 및 배운 점**

- Nest의 구조적 철학을 이해하고 나니 코드가 역할별로 명확히 정리되어  
  유지보수성과 테스트 용이성이 향상됨

### 문제점 ② – 유닛 테스트 설계 부족

- 초기에는 정상 케이스 중심의 테스트만 작성
- Guard/Pipe 단계에서 발생하는 오류 미검증으로 예외 처리 누락 발생

**원인 분석**

- NestJS는 요청 전후 단계별 훅(Guard, Pipe, Interceptor 등)을 제공
- 실패 케이스 부족으로 예상치 못한 에러 조기 발견 어려움

**해결 방법**

- 정상/실패 케이스를 명확히 구분
- 인증 실패, 파라미터 유효성 실패, 내부 로직 에러 등 다양한 상황 포함
- Guard, Pipe 등 요청 전 처리 단계까지 유닛 테스트 적용

**결과 및 배운 점**

- 다양한 실패 케이스 테스트로 조기 에러 발견 가능
- 테스트 커버리지 및 서비스 안정성 향상
- NestJS 구조 이해도가 테스트 설계 명확화에 도움

### 문제점 ③ – 프론트엔드 연동 시 환경 차이로 인한 접근 문제

- 프론트엔드 연동 테스트 중 WSL과 로컬 환경을 병행하다 보니,  
  서버는 실행되지만 브라우저에서 `localhost`로 접근이 안 되거나  
  브라우저 캐싱으로 인한 리다이렉션 문제가 발생함

**원인 분석**

- WSL의 네트워크 인터페이스와 로컬 브라우저의 접근 경로 차이
- 이전 요청 캐시가 남아 있어 API 변경 사항이 즉시 반영되지 않음

**해결 방법**

- 서버 접근 시 `localhost` 대신 WSL IP 주소 직접 사용
- 브라우저 캐시 삭제 및 CORS 설정 재점검
- wsl.conf에 network mirroring 옵션 추가

**결과 및 배운 점**

- 환경 차이 문제를 해결하면서 개발 환경 통일의 중요성을 체감
- 캐싱 및 접근 경로 이슈 대응 경험을 통해 실제 배포 환경 대비 테스트의 필요성 인식

---

## 6. 아쉬운 점 및 개선 방향

- 일부 복잡한 권한 로직의 테스트 커버리지 부족
- 권한 체크 코드 중복 개선 필요
- API 응답 포맷 및 에러 메시지 표준화 필요
- 테스트 자동화 및 CI/CD 환경 구축으로 개발 효율성 향상 가능

---

## 7. 결론

CODIIT-backend 프로젝트를 통해  
모듈화 설계, ORM 활용, 인증/권한, 예외 처리, 유닛 테스트 등  
백엔드 실무 핵심 기술을 종합적으로 경험했습니다.

향후 실제 서비스 환경에서도 안정적 운영을 목표로  
지속적인 개선과 리팩토링을 이어갈 계획입니다.
